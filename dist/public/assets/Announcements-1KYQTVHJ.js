import{i as V,r as a,k as G,l as X,j as e,P as $,m as z,n as Y,o as J,p as R,q as W,s as Z,t as ee,u as te,C as q,b as M,L as w,I as se,B as N,v as ne,h as A,w as D}from"./index-BbEI6kfN.js";import{u as F}from"./useMutation-DsKdg1CA.js";import{T as ae}from"./textarea-BiJHtcHm.js";import{C as re,S as ie,a as ce,b as oe,c as le,d as I}from"./select-BAND5kKC.js";import{u as de}from"./index-DKhwRz1D.js";var T="Checkbox",[ue,Ne]=V(T),[me,xe]=ue(T),B=a.forwardRef((s,c)=>{const{__scopeCheckbox:n,name:h,checked:p,defaultChecked:i,required:f,disabled:u,value:m="on",onCheckedChange:k,form:g,...v}=s,[l,d]=a.useState(null),P=G(c,o=>d(o)),S=a.useRef(!1),x=l?g||!!l.closest("form"):!0,[r=!1,b]=X({prop:p,defaultProp:i,onChange:k}),E=a.useRef(r);return a.useEffect(()=>{const o=l==null?void 0:l.form;if(o){const j=()=>b(E.current);return o.addEventListener("reset",j),()=>o.removeEventListener("reset",j)}},[l,b]),e.jsxs(me,{scope:n,state:r,disabled:u,children:[e.jsx($.button,{type:"button",role:"checkbox","aria-checked":y(r)?"mixed":r,"aria-required":f,"data-state":K(r),"data-disabled":u?"":void 0,disabled:u,value:m,...v,ref:P,onKeyDown:z(s.onKeyDown,o=>{o.key==="Enter"&&o.preventDefault()}),onClick:z(s.onClick,o=>{b(j=>y(j)?!0:!j),x&&(S.current=o.isPropagationStopped(),S.current||o.stopPropagation())})}),x&&e.jsx(he,{control:l,bubbles:!S.current,name:h,value:m,checked:r,required:f,disabled:u,form:g,style:{transform:"translateX(-100%)"},defaultChecked:y(i)?!1:i})]})});B.displayName=T;var L="CheckboxIndicator",_=a.forwardRef((s,c)=>{const{__scopeCheckbox:n,forceMount:h,...p}=s,i=xe(L,n);return e.jsx(Y,{present:h||y(i.state)||i.state===!0,children:e.jsx($.span,{"data-state":K(i.state),"data-disabled":i.disabled?"":void 0,...p,ref:c,style:{pointerEvents:"none",...s.style}})})});_.displayName=L;var he=s=>{const{control:c,checked:n,bubbles:h=!0,defaultChecked:p,...i}=s,f=a.useRef(null),u=de(n),m=J(c);a.useEffect(()=>{const g=f.current,v=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(v,"checked").set;if(u!==n&&d){const P=new Event("click",{bubbles:h});g.indeterminate=y(n),d.call(g,y(n)?!1:n),g.dispatchEvent(P)}},[u,n,h]);const k=a.useRef(y(n)?!1:n);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:p??k.current,...i,tabIndex:-1,ref:f,style:{...s.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function y(s){return s==="indeterminate"}function K(s){return y(s)?"indeterminate":s?"checked":"unchecked"}var U=B,pe=_;const O=a.forwardRef(({className:s,...c},n)=>e.jsx(U,{ref:n,className:R("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...c,children:e.jsx(pe,{className:R("flex items-center justify-center text-current"),children:e.jsx(re,{className:"h-4 w-4"})})}));O.displayName=U.displayName;const fe=W("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ge({className:s,variant:c,...n}){return e.jsx("div",{className:R(fe({variant:c}),s),...n})}function ke(){const[s,c]=a.useState(""),[n,h]=a.useState(""),[p,i]=a.useState("general"),[f,u]=a.useState(!1),[m,k]=a.useState(null),[g,v]=a.useState(null),l=Z(),{toast:d}=ee(),{data:P=[],isLoading:S}=te({queryKey:["/api/announcements"],queryFn:async()=>(await A("GET","/api/announcements")).json()}),x=F({mutationFn:async t=>(await A("POST","/api/announcements",t)).json(),onSuccess:()=>{d({title:"Announcement Created",description:"The announcement has been successfully created",variant:"default"}),D("Create Announcement",`Created announcement: ${s}`),E(),l.invalidateQueries({queryKey:["/api/announcements"]})},onError:t=>{d({title:"Creation Failed",description:`Failed to create announcement: ${t}`,variant:"destructive"})}}),r=F({mutationFn:async t=>(await A("PATCH",`/api/announcements/${t.id}`,t)).json(),onSuccess:(t,C)=>{d({title:"Announcement Updated",description:"The announcement has been successfully updated",variant:"default"}),D("Update Announcement",`Updated announcement ID: ${C.id}`),E(),l.invalidateQueries({queryKey:["/api/announcements"]})},onError:t=>{d({title:"Update Failed",description:`Failed to update announcement: ${t}`,variant:"destructive"})}}),b=F({mutationFn:async t=>(await A("DELETE",`/api/announcements/${t}`)).json(),onSuccess:(t,C)=>{d({title:"Announcement Deleted",description:"The announcement has been successfully deleted",variant:"default"}),D("Delete Announcement",`Deleted announcement ID: ${C}`),v(null),l.invalidateQueries({queryKey:["/api/announcements"]})},onError:t=>{d({title:"Deletion Failed",description:`Failed to delete announcement: ${t}`,variant:"destructive"})}}),E=()=>{c(""),h(""),i("general"),u(!1),k(null)},o=t=>{if(t.preventDefault(),!s.trim()||!n.trim()){d({title:"Missing Fields",description:"Please fill out all required fields",variant:"destructive"});return}m?r.mutate({id:m,title:s,content:n,category:p,isPinned:f}):x.mutate({title:s,content:n,category:p,isPinned:f})},j=t=>{k(t.id),c(t.title),h(t.content),i(t.category),u(t.isPinned),window.scrollTo({top:0,behavior:"smooth"})},Q=()=>{E()},H=t=>({event:"bg-primary text-black",stream:"bg-blue-500",important:"bg-red-500",general:"bg-purple-500"})[t]||"bg-gray-500";return e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-primary",children:"Manage Announcements"}),e.jsx(q,{className:"glass",children:e.jsxs(M,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:m?"Edit Announcement":"Create New Announcement"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"title",className:"text-gray-300",children:"Title"}),e.jsx(se,{id:"title",value:s,onChange:t=>c(t.target.value),className:"bg-zinc-900 border-primary/30 text-white focus:border-primary",placeholder:"Announcement title",disabled:x.isPending||r.isPending})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"category",className:"text-gray-300",children:"Category"}),e.jsxs(ie,{value:p,onValueChange:i,disabled:x.isPending||r.isPending,children:[e.jsx(ce,{className:"bg-zinc-900 border-primary/30 text-white focus:border-primary",children:e.jsx(oe,{placeholder:"Select a category"})}),e.jsxs(le,{className:"bg-zinc-900 border-primary/30",children:[e.jsx(I,{value:"general",children:"General"}),e.jsx(I,{value:"stream",children:"Stream Update"}),e.jsx(I,{value:"event",children:"Special Event"}),e.jsx(I,{value:"important",children:"Important"})]})]})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"content",className:"text-gray-300",children:"Content"}),e.jsx(ae,{id:"content",value:n,onChange:t=>h(t.target.value),className:"bg-zinc-900 border-primary/30 text-white focus:border-primary",placeholder:"Announcement content...",rows:4,disabled:x.isPending||r.isPending})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{id:"isPinned",checked:f,onCheckedChange:t=>u(t===!0),disabled:x.isPending||r.isPending}),e.jsx(w,{htmlFor:"isPinned",className:"text-gray-300",children:"Pin this announcement"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(N,{type:"submit",className:"gold-gradient text-black font-bold hover:opacity-90",disabled:x.isPending||r.isPending,children:x.isPending||r.isPending?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-circle-notch fa-spin mr-2"}),m?"Updating...":"Creating..."]}):e.jsx("span",{children:m?"Update Announcement":"Post Announcement"})}),m&&e.jsx(N,{type:"button",variant:"outline",onClick:Q,className:"border-gray-500 text-gray-400 hover:bg-gray-800",disabled:x.isPending||r.isPending,children:"Cancel"})]})]})]})}),e.jsx(q,{className:"glass",children:e.jsxs(M,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Existing Announcements"}),S?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-primary border-t-transparent animate-spin"})}):P.length===0?e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-8 text-center",children:[e.jsx("i",{className:"fas fa-bullhorn text-4xl text-gray-500 mb-4"}),e.jsx("h4",{className:"text-xl font-bold text-white mb-2",children:"No Announcements Yet"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Create your first announcement to get started"}),e.jsx(N,{className:"gold-gradient text-black font-bold hover:opacity-90",onClick:()=>{var t;return(t=document.getElementById("title"))==null?void 0:t.focus()},children:"Create Announcement"})]}):e.jsx("div",{className:"space-y-4",children:P.map(t=>e.jsxs("div",{className:"p-4 bg-zinc-900 rounded-lg border border-primary/30 hover-gold",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[t.isPinned&&e.jsx("span",{className:"text-primary mr-2",children:e.jsx("i",{className:"fas fa-thumbtack"})}),e.jsx("span",{className:"font-bold",children:t.title})]}),e.jsx(ge,{className:H(t.category),children:t.category})]}),e.jsx("p",{className:"text-gray-300 text-sm mb-3",children:t.content}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[e.jsxs("span",{children:["Posted: ",ne(t.createdAt)]}),e.jsxs("div",{className:"space-x-2",children:[e.jsxs(N,{size:"sm",variant:"ghost",className:"text-blue-400 hover:text-blue-300 h-7 px-2",onClick:()=>j(t),children:[e.jsx("i",{className:"fas fa-edit mr-1"})," Edit"]}),g===t.id?e.jsxs("span",{className:"inline-flex items-center",children:[e.jsxs(N,{size:"sm",variant:"ghost",className:"text-red-500 hover:text-red-400 h-7 px-2",onClick:()=>b.mutate(t.id),disabled:b.isPending,children:[b.isPending?e.jsx("i",{className:"fas fa-circle-notch fa-spin mr-1"}):e.jsx("i",{className:"fas fa-check mr-1"}),"Confirm"]}),e.jsxs(N,{size:"sm",variant:"ghost",className:"text-gray-400 hover:text-gray-300 h-7 px-2",onClick:()=>v(null),disabled:b.isPending,children:[e.jsx("i",{className:"fas fa-times mr-1"})," Cancel"]})]}):e.jsxs(N,{size:"sm",variant:"ghost",className:"text-red-400 hover:text-red-300 h-7 px-2",onClick:()=>v(t.id),children:[e.jsx("i",{className:"fas fa-trash mr-1"})," Delete"]})]})]})]},t.id))})]})})]})}export{ke as default};
