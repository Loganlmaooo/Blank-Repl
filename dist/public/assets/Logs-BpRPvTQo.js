import{r,s as I,t as R,u as k,j as e,C as p,b,B as l,L as m,I as P,w as S,h as f,D}from"./index-BbEI6kfN.js";import{u as w}from"./useMutation-DsKdg1CA.js";import{S as L,a as C,b as T,c as W,d as n}from"./select-BAND5kKC.js";import{S as E}from"./switch-C2cdH4g5.js";import"./index-DKhwRz1D.js";function H(){const[j,v]=r.useState("https://discord.com/api/webhooks/1360625407740612771/2NBUC4S-X55I6FgdE-FMOwJWJ-XHRGtG_o2Q23EuU_XHzJKmy4xjx6IEsVpjYUxuQt4Z"),[x,g]=r.useState("info"),[o,h]=r.useState(!0),c=r.useRef(null),y=I(),{toast:t}=R(),{data:d=[],isLoading:F}=k({queryKey:["/api/admin/logs"],queryFn:async()=>(await f("GET","/api/admin/logs")).json(),refetchInterval:o?5e3:!1}),{data:a,isLoading:B}=k({queryKey:["/api/admin/webhook-settings"],queryFn:async()=>(await f("GET","/api/admin/webhook-settings")).json()}),i=w({mutationFn:async s=>(await f("POST","/api/admin/webhook-settings",s)).json(),onSuccess:()=>{t({title:"Settings Saved",description:"Webhook settings have been saved successfully",variant:"default"}),S("Update Webhook Settings","Updated Discord webhook configuration"),y.invalidateQueries({queryKey:["/api/admin/webhook-settings"]})},onError:s=>{t({title:"Save Failed",description:`Failed to save webhook settings: ${s}`,variant:"destructive"})}}),u=w({mutationFn:D,onSuccess:()=>{t({title:"Webhook Test Successful",description:"Test message sent to Discord webhook",variant:"default"})},onError:s=>{t({title:"Webhook Test Failed",description:`Failed to send test message: ${s}`,variant:"destructive"})}});r.useEffect(()=>{a&&(v(a.url||""),g(a.logLevel||"info"),h(a.realTimeLogging!==!1))},[a]),r.useEffect(()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)},[d]);const U=()=>{i.mutate({url:j,logLevel:x,realTimeLogging:o})},z=()=>{u.mutate()},A=s=>({info:"text-blue-400",warning:"text-yellow-400",error:"text-red-400"})[s]||"text-gray-400",q=s=>new Date(s).toLocaleString("en-US",{timeZone:"America/New_York",dateStyle:"short",timeStyle:"medium"});return e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-primary",children:"System Logs"}),e.jsx(p,{className:"glass",children:e.jsxs(b,{className:"pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Activity Logs"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(L,{value:x,onValueChange:s=>g(s),children:[e.jsx(C,{className:"w-32 h-8 text-xs bg-zinc-900 border-primary/30",children:e.jsx(T,{placeholder:"Log Level"})}),e.jsxs(W,{className:"bg-zinc-900 border-primary/30",children:[e.jsx(n,{value:"info",children:"All Logs"}),e.jsx(n,{value:"warning",children:"Warnings & Errors"}),e.jsx(n,{value:"error",children:"Errors Only"})]})]}),e.jsxs(l,{variant:"outline",size:"sm",className:"border-primary/30 text-primary h-8",onClick:()=>y.invalidateQueries({queryKey:["/api/admin/logs"]}),children:[e.jsx("i",{className:"fas fa-sync-alt mr-1"})," Refresh"]})]})]}),e.jsx("div",{ref:c,className:"bg-zinc-900 font-mono text-sm p-4 rounded-lg h-[calc(100vh-400px)] min-h-[300px] overflow-y-auto",children:F?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("div",{className:"w-10 h-10 rounded-full border-4 border-primary border-t-transparent animate-spin"})}):d.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx("i",{className:"fas fa-info-circle text-2xl mb-2"}),e.jsx("p",{children:"No logs available"})]}):d.map(s=>e.jsxs("div",{className:A(s.level),children:["[",q(s.timestamp),"] ",s.level.toUpperCase(),": ",s.message]},s.id))}),e.jsxs("div",{className:"mt-4 text-gray-400 text-xs flex justify-between items-center",children:[e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"Showing ",d.length," log entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"realTimeLogging",checked:o,onCheckedChange:h}),e.jsx(m,{htmlFor:"realTimeLogging",className:"text-xs",children:"Real-time updates"})]})]})]})}),e.jsx(p,{className:"glass",children:e.jsxs(b,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Webhook Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"webhookUrl",className:"text-gray-300",children:"Discord Webhook URL"}),e.jsx(P,{id:"webhookUrl",value:j,onChange:s=>v(s.target.value),className:"bg-zinc-900 border-primary/30 text-white focus:border-primary",disabled:i.isPending}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"All system logs will be sent to this Discord webhook"]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"logLevelSelect",className:"text-gray-300",children:"Log Level"}),e.jsxs(L,{value:x,onValueChange:s=>g(s),disabled:i.isPending,children:[e.jsx(C,{id:"logLevelSelect",className:"bg-zinc-900 border-primary/30 text-white focus:border-primary",children:e.jsx(T,{placeholder:"Select Log Level"})}),e.jsxs(W,{className:"bg-zinc-900 border-primary/30",children:[e.jsx(n,{value:"info",children:"Info (All logs)"}),e.jsx(n,{value:"warning",children:"Warning (Warnings and Errors only)"}),e.jsx(n,{value:"error",children:"Error (Errors only)"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"realTimeWebhookLogging",checked:o,onCheckedChange:h,disabled:i.isPending}),e.jsx(m,{htmlFor:"realTimeWebhookLogging",className:"text-gray-300",children:"Enable real-time logging"})]}),e.jsxs("div",{className:"pt-2 flex space-x-2",children:[e.jsx(l,{onClick:U,className:"gold-gradient text-black font-bold hover:opacity-90",disabled:i.isPending,children:i.isPending?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-circle-notch fa-spin mr-2"}),"Saving..."]}):"Save Webhook Settings"}),e.jsx(l,{onClick:z,className:"bg-[#6441A4]/80 text-white font-bold hover:bg-[#6441A4] transition",disabled:u.isPending,children:u.isPending?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-circle-notch fa-spin mr-2"}),"Testing..."]}):"Test Webhook"})]})]})]})}),e.jsx(p,{className:"glass",children:e.jsxs(b,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"System Backups"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-zinc-900 p-4 rounded-lg border border-primary/20",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Last Backup"}),e.jsx("p",{className:"text-lg font-semibold",children:B?"Loading...":(a==null?void 0:a.lastBackup)||"Never"})]}),e.jsxs("div",{className:"bg-zinc-900 p-4 rounded-lg border border-primary/20",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Backup Frequency"}),e.jsx("p",{className:"text-lg font-semibold",children:"Every 5 minutes"})]}),e.jsxs("div",{className:"bg-zinc-900 p-4 rounded-lg border border-primary/20",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Backup Status"}),e.jsxs("p",{className:"text-lg font-semibold flex items-center",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 mr-2"}),"Active"]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(l,{className:"bg-primary/20 text-primary hover:bg-primary/30 transition",onClick:()=>{t({title:"Manual Backup Started",description:"A manual backup has been initiated",variant:"default"}),S("Manual Backup","Initiated a manual system backup")},children:[e.jsx("i",{className:"fas fa-download mr-2"})," Manual Backup"]}),e.jsxs(l,{variant:"outline",className:"border-primary/30 text-primary",onClick:()=>{t({title:"Backup Settings",description:"Backup configuration screen would open here",variant:"default"})},children:[e.jsx("i",{className:"fas fa-cog mr-2"})," Backup Settings"]})]})]})})]})}export{H as default};
