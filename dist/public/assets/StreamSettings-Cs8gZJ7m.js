import{r as m,s as T,t as k,u as y,j as e,C as b,b as N,L as o,I as q,B as v,x as S,h as w,w as F,y as z}from"./index-BbEI6kfN.js";import{u as U}from"./useMutation-DsKdg1CA.js";import{S as P,a as G,b as R,c as V,d as u}from"./select-BAND5kKC.js";import"./index-DKhwRz1D.js";function D(){const[d,g]=m.useState("auto"),[x,p]=m.useState(""),[n,j]=m.useState(null),f=T(),{toast:r}=k(),{data:t,isLoading:M}=y({queryKey:["/api/admin/stream-settings"],queryFn:async()=>(await w("GET","/api/admin/stream-settings")).json()}),{data:a,isLoading:I}=y({queryKey:["/api/twitch/streamers"],queryFn:z}),l=U({mutationFn:async s=>(await w("POST","/api/admin/stream-settings/featured",s)).json(),onSuccess:(s,i)=>{r({title:"Stream Settings Updated",description:"Featured stream has been updated successfully",variant:"default"}),F("Update Featured Stream",`Changed featured stream to: ${i.featured}${i.customUrl?" (custom URL)":""}`),f.invalidateQueries({queryKey:["/api/admin/stream-settings"]})},onError:s=>{r({title:"Update Failed",description:`Failed to update featured stream: ${s}`,variant:"destructive"})}}),h=U({mutationFn:async s=>{const i=new FormData;i.append("scheduleImage",s);const c=await fetch("/api/admin/stream-settings/schedule-image",{method:"POST",body:i,credentials:"include"});if(!c.ok){const A=await c.text();throw new Error(A||c.statusText)}return c.json()},onSuccess:()=>{r({title:"Image Uploaded",description:"Schedule image has been uploaded successfully",variant:"default"}),F("Upload Schedule Image","Updated stream schedule image"),j(null),f.invalidateQueries({queryKey:["/api/admin/stream-settings"]})},onError:s=>{r({title:"Upload Failed",description:`Failed to upload schedule image: ${s}`,variant:"destructive"})}}),C=()=>{const s={featured:d};d==="custom"&&x&&(s.customUrl=x),l.mutate(s)},L=s=>{s.target.files&&s.target.files[0]&&j(s.target.files[0])},E=()=>{n&&h.mutate(n)};return m.useState(()=>{t&&(g(t.featuredStream||"auto"),t.customEmbedUrl&&p(t.customEmbedUrl))}),e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-primary",children:"Stream Settings"}),e.jsx(b,{className:"glass",children:e.jsxs(N,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Featured Stream"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"featuredStream",className:"text-gray-300",children:"Select Featured Stream"}),e.jsxs(P,{value:d,onValueChange:g,disabled:l.isPending,children:[e.jsx(G,{id:"featuredStream",className:"bg-zinc-900 border-primary/30 text-white focus:border-primary",children:e.jsx(R,{placeholder:"Select Featured Stream"})}),e.jsxs(V,{className:"bg-zinc-900 border-primary/30",children:[e.jsx(u,{value:"auto",children:"Auto Detect Live Stream"}),e.jsx(u,{value:"main",children:"Main Channel (IRL)"}),e.jsx(u,{value:"gaming",children:"Gaming Channel"}),e.jsx(u,{value:"custom",children:"Custom Embed"})]})]})]}),d==="custom"&&e.jsxs("div",{children:[e.jsx(o,{htmlFor:"customEmbedUrl",className:"text-gray-300",children:"Custom Embed URL"}),e.jsx(q,{id:"customEmbedUrl",value:x,onChange:s=>p(s.target.value),className:"bg-zinc-900 border-primary/30 text-white focus:border-primary",placeholder:"https://player.twitch.tv/?channel=...",disabled:l.isPending})]}),e.jsx("div",{children:e.jsx(v,{onClick:C,className:"gold-gradient text-black font-bold hover:opacity-90",disabled:l.isPending,children:l.isPending?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-circle-notch fa-spin mr-2"}),"Updating..."]}):"Update Featured Stream"})})]})]})}),e.jsx(b,{className:"glass",children:e.jsxs(N,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Stream Information"}),I?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-primary border-t-transparent animate-spin"})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-zinc-900 p-4 rounded-lg border border-primary/20",children:[e.jsxs("h4",{className:"font-bold flex items-center",children:[e.jsx("i",{className:"fas fa-video text-[#6441A4] mr-2"})," Main Channel (IRL)"]}),e.jsxs("div",{className:"mt-2 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("span",{className:a!=null&&a.main.isLive?"text-green-500 font-semibold":"text-gray-500 font-semibold",children:a!=null&&a.main.isLive?"LIVE":"OFFLINE"})]}),(a==null?void 0:a.main.isLive)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Current Viewers:"}),e.jsx("span",{children:a==null?void 0:a.main.viewers})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Stream Title:"}),e.jsx("span",{children:a==null?void 0:a.main.title})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Started:"}),e.jsx("span",{children:a!=null&&a.main.startedAt?S(a.main.startedAt):"Unknown"})]}),(a==null?void 0:a.main.game)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Game/Category:"}),e.jsx("span",{children:a.main.game})]})]})]})]}),e.jsxs("div",{className:"bg-zinc-900 p-4 rounded-lg border border-primary/20",children:[e.jsxs("h4",{className:"font-bold flex items-center",children:[e.jsx("i",{className:"fas fa-gamepad text-[#6441A4] mr-2"})," Gaming Channel"]}),e.jsxs("div",{className:"mt-2 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("span",{className:a!=null&&a.gaming.isLive?"text-green-500 font-semibold":"text-gray-500 font-semibold",children:a!=null&&a.gaming.isLive?"LIVE":"OFFLINE"})]}),a!=null&&a.gaming.isLive?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Current Viewers:"}),e.jsx("span",{children:a==null?void 0:a.gaming.viewers})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Stream Title:"}),e.jsx("span",{children:a==null?void 0:a.gaming.title})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Started:"}),e.jsx("span",{children:a!=null&&a.gaming.startedAt?S(a.gaming.startedAt):"Unknown"})]}),(a==null?void 0:a.gaming.game)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Game/Category:"}),e.jsx("span",{children:a.gaming.game})]})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Last Live:"}),e.jsx("span",{children:(t==null?void 0:t.lastGameStream)||"Unknown"})]})]})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-700",children:[e.jsx("h4",{className:"font-bold mb-4",children:"Schedule Settings"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(o,{htmlFor:"scheduleImage",className:"text-gray-300",children:"Upload Stream Schedule Image"}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"file",id:"scheduleImage",className:"hidden",onChange:L,accept:"image/*"}),e.jsx(o,{htmlFor:"scheduleImage",className:"px-4 py-2 rounded-md bg-zinc-800 text-primary border border-primary/30 cursor-pointer hover:bg-zinc-700 transition",children:"Choose File"}),e.jsx("span",{className:"ml-3 text-sm text-gray-400",children:n?n.name:"No file chosen"})]}),n&&e.jsx("div",{className:"mt-3",children:e.jsx(v,{onClick:E,className:"gold-gradient text-black font-bold hover:opacity-90",disabled:h.isPending,children:h.isPending?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-circle-notch fa-spin mr-2"}),"Uploading..."]}):"Upload Schedule Image"})}),(t==null?void 0:t.scheduleImageUrl)&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Current Schedule Image:"}),e.jsx("div",{className:"bg-zinc-900 p-2 rounded border border-primary/20",children:e.jsx("img",{src:t.scheduleImageUrl,alt:"Stream Schedule",className:"max-h-60 rounded mx-auto"})})]})]})})]})]})})]})}export{D as default};
